#!/bin/sh
if [ -f /sbin/ifconfig ]; then
	ifconfig $INTERFACE {%- if tinc['network'][network]['master'] is defined and tinc['network'][network]['master'][node] is defined -%}
	{{ " " + tinc['network'][network]['master'][node]['local-ip'] + " " }}
	{%- else -%}
	{{ " " + tinc['network'][network]['node'][node]['local-ip'] + " " }}
	{%- endif -%} netmask 255.255.0.0
elif [ -f /sbin/ip ]; then
	ip addr add {%- if tinc['network'][network]['master'] is defined and tinc['network'][network]['master'][node] is defined -%}
	{{ " " + tinc['network'][network]['master'][node]['local-ip'] + "/" + tinc['network'][network]['subnet'].split('/')[1] + " " }}
	{%- else -%}
	{{ " " + tinc['network'][network]['node'][node]['local-ip'] + "/" + tinc['network'][network]['subnet'].split('/')[1] + " " }}
	{%- endif -%} dev $INTERFACE
	ip link set $INTERFACE up
fi